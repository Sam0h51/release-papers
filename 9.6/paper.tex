\documentclass{ansarticle-preprint}
%\usepackage{ucs}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
%\usepackage{cite}
\usepackage{anslistings}
\usepackage{multicol}
\usepackage{pdfsync}
\usepackage{enumitem}

\usepackage{pgfplots}
\usepackage{pgfplotstable}

\usepackage{fontenc}
\usepackage{graphicx}
\usepackage{xspace}

\usepackage{siunitx}

\usepackage{floatflt}

\usepackage{multirow}

\usepackage{booktabs}

%\renewcommand{\baselinestretch}{2.0}
%\usepackage{lineno}
%\renewcommand\linenumberfont{\normalfont\tiny}
%\linenumbers

\graphicspath{{svg/}}

\usepackage[normalem]{ulem}

\usepackage{caption}
\usepackage{subcaption}

\usepackage{todonotes}

\pgfplotsset{compat=1.9}
\definecolor{gnuplot@lightblue}{RGB}{87,181,232}
\definecolor{gnuplot@green}{RGB}{0,158,115}
\definecolor{gnuplot@purple}{RGB}{148,0,212}

\newcommand{\specialword}[1]{\texttt{#1}}
\newcommand{\dealii}{{\specialword{deal.II}}\xspace}
\newcommand{\pfrst}{{\specialword{p4est}}\xspace}
\newcommand{\trilinos}{{\specialword{Trilinos}}\xspace}
\newcommand{\aspect}{\specialword{Aspect}\xspace}
\newcommand{\petsc}{\specialword{PETSc}\xspace}
\newcommand{\snes}{{\specialword{SNES}}\xspace}
\newcommand{\ts}{{\specialword{TS}}\xspace}
\newcommand{\petscsf}{{\specialword{SF}}\xspace}
\newcommand{\cmake}{{\specialword{CMake}}\xspace}
\newcommand{\candi}{{\specialword{candi}}\xspace}
\newcommand{\MPI}{{\specialword{MPI}}\xspace}
\newcommand{\MPIx}{{\specialword{MPI+X}}\xspace}
\newcommand{\sundials}{{\specialword{SUNDIALS}}\xspace}
\newcommand{\kinsol}{{\specialword{KINSOL}}\xspace}
\newcommand{\ida}{{\specialword{IDA}}\xspace}
\newcommand{\arkode}{{\specialword{ARKODE}}\xspace}
\newcommand{\boost}{{\specialword{Boost}}\xspace}
\newcommand{\kokkos}{{\specialword{Kokkos}}\xspace}
\newcommand{\llvm}{{\specialword{LLVM}}\xspace}
\newcommand{\step}[1]{{\specialword{step-#1}}\xspace}

%Trilinos Packages
\newcommand{\epetra}{{\specialword{Epetra}}\xspace}
\newcommand{\petra}{{\specialword{Petra}}\xspace}
\newcommand{\teuchos}{{\specialword{Teuchos}}\xspace}
\newcommand{\tpetra}{{\specialword{Tpetra}}\xspace}


\usetikzlibrary{shapes.misc}
\tikzset{cross/.style={cross out, draw=black, minimum size=2*(#1-\pgflinewidth), inner sep=0pt, outer sep=0pt},
%default radius will be 1pt.
cross/.default={2pt}}

%
% Author list -- please add yourself in both places below (in
%                alphabetical order) if you think that your
%                contributions to the last release warrant this
%

\hypersetup{
  pdfauthor={
    Pasquale Claudio Africa,
    Daniel Arndt,
    Wolfgang Bangerth,
    Bruno Blais,
    Marc Fehling,
    Rene Gassm\"{o}ller,
    Timo Heister,
    Luca Heltai,
    Martin Kronbichler,
    Matthias Maier,
    Peter Munch,
    Magdalena Schreter-Fleischhacker,
    Jan Philipp Thiele,
    Bruno Turcksin,
    David Wells,
    Vladimir Yushutin
  },
  pdftitle={The deal.II Library, Version 9.6, 2024},
}

\title{The \dealii Library, Version 9.6}

 \author[1]{Pasquale~Claudio~Africa}
 \affil[1]{SISSA International School for Advanced Studies,
   mathLab,
   Via Bonomea, 265,
   34136, Trieste, Italy.
   \texttt{pafrica@sissa.it}}

 \author[2*]{Daniel Arndt}
 \affil[2]{Computational Coupled Physics Group,
   Computational Sciences and Engineering Division,
   Oak Ridge National Laboratory, 1 Bethel Valley Rd.,
   TN 37831, USA.
   \texttt{arndtd/turcksinbr@ornl.gov}}

 \author[3,4]{Wolfgang~Bangerth}
 \affil[3]{Department of Mathematics, Colorado State University, Fort
   Collins, CO 80523-1874, USA.
   \texttt{bangerth@colostate.edu}}
 \affil[4]{Department of Geosciences, Colorado State University, Fort
   Collins, CO 80523, USA.}

\author[5]{Bruno Blais}
\affil[5]{Chemical Engineering High-performance Analysis, Optimization and Simulation (CHAOS) laboratory, Department of Chemical Engineering,
             Polytechnique Montréal,
             PO Box 6079, Stn Centre-Ville, Montréal, Québec, Canada, H3C 3A7.
             {\texttt{bruno.blais@polymtl.ca}}}

\author[6]{Marc~Fehling}
 \affil[6]{Department of Mathematical Analysis,
    Faculty of Mathematics and Physics, Charles University,
    Sokolovsk{\'a} 49/83, 186\,75 Prague 8, Czech Republic.
    {\texttt{marc.fehling@matfyz.cuni.cz}}}


\author[7]{Rene~Gassm\"{o}ller}
\affil[7]{GEOMAR Helmholtz Centre for Ocean Research Kiel, 24148 Kiel, Germany}

\author[8]{Timo~Heister}
 \affil[8]{School of Mathematical and Statistical Sciences,
   Clemson University,
   Clemson, SC, 29634, USA.
   {\texttt{heister@clemson.edu}}}

\author[9]{Luca~Heltai}
\affil[9]{University of Pisa, Italy.}

\author[10]{Sebastian~Kinnewig}
\affil[10]{Institute for Applied Mathematics, Scientific Computing,
           Leibniz University Hannover,
           Welfengarten 1, 30167 Hannover, Germany
           {\texttt{kinnewig@ifam.uni-hannover.de}}}

 \author[11,12]{Martin~Kronbichler}
 \affil[11]{Faculty of Mathematics, Ruhr University Bochum,
   Universit\"atsstr.~150, 44780 Bochum, Germany.
 {\texttt{martin.kronbichler@rub.de}}}
 \affil[12]{Institute of Mathematics,
   University of Augsburg,
   Universit\"atsstr.~12a, 86159 Augsburg, Germany.
   }

\author[13]{Matthias~Maier}
\affil[13]{Department of Mathematics,
  Texas A\&M University,
  3368 TAMU,
  College Station, TX 77845, USA.
  {\texttt{maier@math.tamu.edu}}}

\author[12,14]{Peter Munch}
 \affil[14]{Uppsala University, Sweden.
  {\texttt{peter.munch@it.uu.se}}}

\author[15]{Magdalena Schreter-Fleischhacker}
 \affil[15]{Institute for Computational Mechanics, Technical University of Munich, Boltzmannstraße 15, 85748 Garching, Germany.
  {\texttt{magdalena.schreter@tum.de}}}

\author[16]{Jan Philipp Thiele}
 \affil[16]{Weierstrass Institute for Applied Analysis and Stochastics,\newline
 Leibniz Institute in Forschungsverbund Berlin e.V.
  {\texttt{thiele@wias-berlin.de}}}

\author[2*]{Bruno~Turcksin}

\author[17]{David Wells}
\affil[17]{Department of Mathematics, University of North Carolina,
  Chapel Hill, NC 27516, USA.
  {\texttt{drwells@email.unc.edu}}}

\author[8, 18]{Vladimir Yushutin}
\affil[18]{Department of Mathematics, University of Tennessee at Knoxville,
	 Knoxville TN 37996-1320, USA.
{\texttt{vyushuti@utk.edu}}}


\renewcommand{\labelitemi}{--}


\begin{document}
\maketitle

\footnotetext{%
  $^\ast$ This manuscript has been authored by UT-Battelle, LLC under Contract No.
  DE-AC05-00OR22725 with the U.S. Department of Energy.
  % We need to submit the manuscript with the text below. If the editor
  % complains we can remove it.
  The United States
  Government retains and the publisher, by accepting the article for
  publication, acknowledges that the United States Government retains a
  non-exclusive, paid-up, irrevocable, worldwide license to publish or reproduce
  the published form of this manuscript, or allow others to do so, for United
  States Government purposes. The Department of Energy will provide public
  access to these results of federally sponsored research in accordance with the
  DOE Public Access Plan (http://energy.gov/downloads/doe-public-access-plan).
}


\begin{abstract}
  This paper provides an overview of the new features of the finite element
  library \dealii, version 9.6.
\end{abstract}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Overview}

\dealii version 9.6.0 was released August 11, 2024. This paper provides an
overview of the new features of this release and serves as a citable
reference for the \dealii software library version 9.6. \dealii is an
object-oriented finite element library used around the world in the
development of finite element solvers. It is available for free under the
terms of the \emph{GNU Lesser General Public License} (LGPL). The \dealii
project is in the process of relicensing the library under the terms of
the \emph{Apache License} 2.0 with \emph{LLVM Exception}. Downloads are
available at \url{https://www.dealii.org/} and
\url{https://github.com/dealii/dealii}.

The major changes of this release are:
%
\begin{itemize}
  \item
    Substantial performance improvements to the matrix-free and multigrid
    infrastructure (Section~\ref{sec:mf}).
  \item
    Additions to the non-matching infrastructure (see
    Section~\ref{sec:nonmatching}). In particular, the new class
    \texttt{FERemoteEvaluation} provides support for evaluating finite
    element shape functions and solutions on parts of the domain stored by
    other MPI processes.
  \item
    Much work has gone into writing wrappers for \trilinos' \tpetra{} stack
    of linear algebra classes. \tpetra{} is \trilinos' \kokkos-based
    replacement for the now-deprecated \epetra{} stack. See
    Section~\ref{sec:tpetra} for more on this.
  \item
    Tool classes \texttt{TaskResult} and \texttt{Lazy} that provide ways to
    compute values on a separate thread or only when first accessed
    (Section~\ref{sec:tools}).
  \item
    There are six new tutorial programs, on checkpointing simulations
    (\step{83}), integrating time-dependent solvers with external time
    stepping libraries (\step{86}, using \petsc's \ts{} library), advanced
    point evaluation techniques (\step{87}), non-matching grids (\step{89}),
    and trace-based methods for PDEs on embedded surfaces (\step{90}). See
    Section~\ref{subsec:steps} for more details.
  \item
    In Section~\ref{sec:license} we summarize the motivation and approach
    behind our relicensing effort to make \dealii available under the terms
    of the the Apache License 2.0 with LLVM Exception.
\end{itemize}
%

While all of these major changes are discussed in detail in
Section~\ref{sec:major}, there
are a number of other noteworthy changes in the current \dealii release,
which we briefly outline in the remainder of this section:
%
\begin{itemize}
  \item \dealii{} now requires and makes use of the C++17 language standard.
  \item We have continued to make progress in supporting simplex and
    mixed meshes -- mesh types that \dealii{} has traditionally not
    supported at all. Specifically, the current release uses
    better strategies for refinement of tetrahedra that result in
    better-shaped child cells. It also contains
    support for cubic finite elements on simplices.
  \item The \texttt{FE\_NedelecSZ} class that contains our
    implementation of the N\'ed\'elec element using the orientation
    scheme of \cite{Zag06} now supports the computation of hanging
    node constraints for locally refined meshes.
    \todo[inline]{Sebastian: Is there anything more to say here, maybe some reference? If
      you want, we can also list this point in the list above, and add
      a whole section 2.x for it. If you think there is nothing more
      that needs to be said, just delete this note.}
  \item The \texttt{AffineConstraints} class stores and processes
    constraints on degrees of freedom in \dealii{}. Such constraints
    can be of the (homogeneous) form $x_3 = \frac 12 x_{14} + \frac 12 x_{15}$ as is
    common when using hanging node constraints (here, $x_3$ could
    represent the value of the solution at a hanging node, and $x_{14}$
    and $x_{15}$ are the values of the two adjacent degrees of freedom on
    the parent edge that contains the hanging node); or they can be of
    the form $x_{12}=42$ as is common when using Dirichlet boundary
    the (inhomogeneous) form $x_{12}=42$ as is common when using Dirichlet boundary
    conditions.

    Since very early in the history of the library, the
    \texttt{AffineConstraints} class interface required building such
    constraints in multiple steps: First, one declared a degree of
    freedom as constrained; then one added the dependencies one after
    the other (e.g., by adding pairs $(\frac 12, 14)$ and $(\frac 12,
    15)$ in the hanging node example above); then one added
    inhomogeneities (by setting it to $42$ in the Dirichlet example
    above). This piecemeal approach is cumbersome and prevents the
    library from performing certain error checking steps because a
    constraint is not known to be completely built at any given point. The new
    \texttt{add\_constraint()} function now allows defining a
    constraint in one step.
  \item We refactored the systems for managing relative line and face
    orientations to significantly improve consistency across several library
    modules, including finite element classes, periodicity, and the
    \pfrst{} interface. \dealii{} has supported using unstructured
    three-dimensional meshes for a long time. Features like discontinuous
    Galerkin methods and higher-order elements require that lines and faces of
    adjacent elements are consistently oriented. For example, consider a line
    containing two degrees of freedom, which, in reference coordinates, are
    located at $x_1 = \frac 1 3$ and $x_2 = \frac 2 3$. If the line is read from
    left-to-right then we get points $(x_1, x_2)$ whereas if it is read from
    right-to-left we get $(x_2, x_1)$. \dealii{} guarantees that this order will
    be consistent across all cells sharing that line by storing a flag
    indicating whether (relative to the vertex enumeration on the present cell)
    that particular line is in the standard or reversed orientation. Faces in 3d
    are treated in a similar way. The only significant difference between lines
    and 3d faces is that, instead of two possible relative orientations,
    triangular faces have six and quadrilateral faces have eight
    possible orientations.

    Historically, different places within the library implemented their own
    ad-hoc orientation logic, data encodings, and default values. We cleaned up
    this subsystem and instead of using three different booleans
    (\emph{orientation}, \emph{rotation}, and \emph{flip}), bitsets, or several
    other encodings, we now use a single \texttt{unsigned char} which we named the
    \emph{combined orientation}. Since the representation in some library
    interfaces has changed, most of the old interfaces have been deprecated and
    a few (such as the low-level interface to periodic boundary conditions) had
    to be incompatibly altered or removed.
\item The \texttt{SolverGMRES} class now offers a third orthogonalization
  method, the classical Gram--Schmidt method with delayed orthogonalization
  \cite{Bielich2022}. Furthermore, the solver now specifies the maximal basis
  size of the Arnoldi basis, rather than the number of auxiliary
  vectors. Some changes have also been made to the GMRES and F-GMRES
  implementations, making them use the same underlying kernels as much as possible.
\item The new class \texttt{FE\_Hermite} implements a Hermite interpolation basis of
  maximum regularity. These bases are always of odd polynomial degree $p$ and have
  regularity $r=(p-1)/2$.
\end{itemize}
%
The
\href{https://dealii.org/developer/doxygen/deal.II/changes_between_9_5_2_and_9_6_0.html}{changelog}
-- listing more than 180 features and bugfixes --
contains a complete record of all changes; see \cite{changes96}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Major changes to the library}
\label{sec:major}

This release of \dealii contains a number of large and significant changes,
which we will discuss in this section.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Updates to the multigrid and matrix-free algorithms}\label{sec:mf}

We updated a number of significant parts of the multigrid and matrix-free
infrastructure in \dealii. These changes include:
\begin{itemize}
\item Our own implementation of the \texttt{std::experimental::simd}
  class proposed for inclusion into the C++ standard, called
  \texttt{VectorizedArray}, now also supports Arm Neon. Arm Neon is an
  architecture extension of the ARMv7, ARMv8 and ARMv9 architecture families,
  used, e.g., for the Arm Cortex-A and Arm Cortex-R series of processors or in
  the Apple 64-bit silicon series (A7--A18, M1--M4 as of 2024).
  With these instructions, 2 doubles or 4 floats can be processed in one
  go. Since the matrix-free infrastructure works directly with the \texttt{VectorizedArray}
  abstraction as data structure, it automatically benefits from this new implementation.

\item The application of the Piola transformation for values and gradients of
  $H$(div)-conforming Raviart--Thomas elements on non-Cartesian cells has
  been rewritten for better performance. Together with additional changes in
  the sum-factorization algorithms, which became more similar to the kernels
  described in~\cite{KronbichlerKormann2019}, the matrix-free operator
  evaluation is now 3--5 times faster in these cases.

\item Furthermore, we improved the internal data structures of the tensor-product
  evaluators as well as the evaluators for simplex elements.  This speeds up
  the operator evaluation in several scenarios, especially for simplices
  (around two times higher throughput for operator evaluation) and
  multi-component systems. The restructuring made to enable these optimizations
  also reduces the compile times and the size of the generated code slightly.

\item In addition, we performed substantial improvements to the global-coarsening
  multigrid infrastructure: \texttt{MGTransferMF} (previously:
  \texttt{MGTransferGlobalCoarsening}) and \texttt{MGTwoLevel\-Transfer}. They
  now allow performing local smoothing, which is a key step towards unifying
  all transfer operators in \dealii. Finally, \texttt{MGTwoLevelTransfer} can now
  be set up with an existing \texttt{MatrixFree} object in the case
  of $p$-multigrid, reducing the setup costs and memory consumption significantly.
\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Advances in non-matching support}\label{sec:nonmatching}

%\todo[inline]{All: If you contributed to this functionality, please
%  help flesh out this section.}

In the non-matching infrastructure of \dealii, we made the following improvements:

\begin{itemize}
\item The performance of the non-nested multigrid infrastructure
(\texttt{MGTwoLevelTransferNon\-Nested}) has been improved significantly by avoiding
redundant copy operations. Furthermore, support for simplex-shaped cells and
multiple-component elements has been added.
\item Several minor performance improvements in \dealii's evaluator class on
  sets of unstructured points, \texttt{FEPointEvaluation}, have been
  made. The changes are particularly useful for evaluating several quantities on the
  same set of points, which is enabled by \texttt{NonMatching::MappingInfo}.
\item We added the new class \texttt{FERemoteEvaluation}.
This is a class to access data
in a distributed matrix-free loop for non-matching discretizations.
Interfaces are named in analogy to \texttt{FEEvaluation}, in order to seamlessly switch the
local evaluator functionality at quadrature points of a computation. The key component is the
underlying MPI communication infrastructure, which is performed via \texttt{RemotePointEvaluation}.
Tutorial \step{89} has been added to present its usage
in the context of the application to acoustic conservation equations~\cite{heinz2023high}.
\item FECouplingValues

\todo[inline]{Luca: Please complete}
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Interface to the \trilinos{} \tpetra{} stack}\label{sec:tpetra}

\dealii{}'s parallel linear algebra facilities (apart from matrix-free capabilities) are largely built on
wrappers around functionality provided by the \petsc{} and \trilinos{} libraries.

Historically, \trilinos{} has implemented distributed linear algebra classes for vectors and (sparse) matrices in its
\epetra{} package that uses \MPI{} as its only source of
parallelism. Building on that, there are multiple interconnected \trilinos{} packages, e.g.\ for (non-)linear solvers 
and preconditioners, commonly referred to as the 
``\epetra{} stack''. For sake of brevity we will also refer to the whole stack as \epetra{} in the following.
\dealii{}'s interfaces to \trilinos{} have traditionally 
been implemented to use it.

However, several years ago, \trilinos{} also introduced the
newer \tpetra{} (``templated'' Petra) package that provides additional shared memory
parallelism and GPU capabilities, referred to as \MPIx, by building on \kokkos{}. 
In recent years, new features have only been implemented in \tpetra{} as 
it is slated to replace \epetra{}, and the latter is indeed
now deprecated with removal slated for 2025. 
As a consequence, 
we will eventually have to switch all of our \trilinos{} interfaces to \tpetra{}; 
the same is true for the need to switch to \tpetra{}-based
sub-packages (the ``Tpetra stack'') that are intended to replace existing \trilinos{} sub-packages 
(for example, \texttt{Ifpack2} instead of \texttt{Ifpack}).

In the current release, we have put substantial work into this switch,
as outlined below. As this is not yet finished, it is important to note that 
all these features are optional and their individual availability
depends on the installed \trilinos{} packages. 
As an example, a \dealii{} build will pass with a \trilinos{} installation 
without \texttt{Ifpack2}, but its preconditioners will not be included.
In the following list, we omit the common namespace prefix
\texttt{LinearAlgebra::} on all mentioned
\texttt{TpetraWrappers} symbols for readability:
\begin{itemize}
  \item The \texttt{TpetraWrappers::Vector} class has been overhauled to also allow specifying
    a memory space, and the \texttt{TpetraWrappers::BlockVector} class has been added.
  \item \texttt{TpetraWrappers::SparseMatrix} and \texttt{TpetraWrappers::SparsityPattern} have been implemented mirroring
    the functionality of the \texttt{TrilinosWrappers::SparseMatrix} \\ and \texttt{TrilinosWrappers::SparsityPattern} classes.
  \item Various incomplete factorization and relaxation preconditioners (from \texttt{Ifpack2}) have been wrapped,
    mirroring the existing classes in \texttt{LinearAlgbera::TrilinosWrappers} as closely as possible.
  \item Two new preconditioner variants \texttt{TpetraWrappers::PreconditionL1Jacobi} and \\
    \texttt{TpetraWrappers::PreconditionL1GaussSeidel}, based on~\cite{BFKY2011}, have been added.
  \item \texttt{TpetraWrappers::SolverDirectKLU2} is now available as a direct solver.
\end{itemize}
Some functionality in these wrapper classes is still missing, 
most noticeably wrappers for the algebraic-multigrid preconditioner \texttt{MueLu}
and the iterative solvers from \texttt{Belos}.
However, the wrapped \texttt{Ifpack2} preconditioners can already be used with the iterative solvers of \dealii{}.

The solver and preconditioner classes mentioned above provide reasonable parameter subsets 
through \texttt{AdditionalData} objects, just as the existing
\texttt{Epetra} wrappers. 
Additionally, there are new generic classes \texttt{TpetraWrappers::SolverDirect} 
and \texttt{TpetraWrappers::PreconditionIfpack} which expose the internal interface through
a \texttt{Teuchos::ParameterList} and thereby offering the full set of parameters for 
more experienced \trilinos{} users. This also allows the use of preconditioners or 
solvers not (yet) wrapped, e.g.\ \texttt{SuperLU\_dist} or \texttt{MUMPS}.

The design goal was to introduce as few changes as possible for the user to allow for an easy transition to the
\texttt{TpetraWrappers} classes.
However, based on the difference between \epetra{} and \tpetra{}, the following changes were necessary:
\begin{itemize}
  \item The constructor for the class \texttt{TrilinosWrappers::MPI::Vector} only required the \texttt{IndexSet locally\_owned},
    which describes the set of indices locally owned by the current rank.
    However, if one wants to create a vector that has read or write access to non-locally owned indices,  the constructor of the
    \texttt{TpetraWrappers::Vector} requires the \texttt{IndexSet locally\_owned}, the \texttt{IndexSet locally\_relevant}, and
    a boolean flag, whether to initialize the vector in the read-only or the write-only state.
    This interface is in fact close to the one of \dealii{}'s own parallel vector class.
  \item A vector created without providing the \texttt{IndexSet locally\_relevant} is purely local and cannot access non-local indices.
    Such a vector cannot be copied to a vector that can access non-local indices, as the \texttt{IndexSet locally\_relevant} must
    be provided at creating the vector object. 
  \item Some of parameters of existing solver and preconditioner are
    not available in the \tpetra{} wrappers,
    such that the corresponding \texttt{AdditionalData} objects are not identical. 
    Since there are many preconditioners we will not list each individual change but instead refer 
    to our Doxygen documentation. 
  \item The incomplete Cholesky (IC) factorization preconditioner is not available 
   in \tpetra{}.
\end{itemize}

Another goal was increasing the interoperability of \dealii{} and \trilinos{},
allowing users familiar with both to write `pure' \trilinos{} code within their 
applications, e.g.\ to test or develop a new feature.
Therefore, the internal data is stored as it would be in a \trilinos{} 
application code (as \texttt{Teuchos::RCP}) and can be accessed through member functions. 
In fact, one of the authors has already used this to apply the domain decomposition preconditioner
\texttt{FROSch} to various problems discretized using \dealii{}.
\todo[inline]{Kinnewig: Add citation to preprint?}

Finally,
all \texttt{TpetraWrappers} classes take \texttt{Number} and \texttt{MemorySpace} template arguments,
in order to control the underlying scalar type and memory space.
By default, memory is allocated on the CPU, mirroring the behavior of
the \texttt{TrilinosWrappers}, but choosing a different memory space
also allows \tpetra{} to utilize GPUs if \kokkos{} is configured
with a GPU backend.
Furthermore, to fully leverage the GPU backend and unlock its full potential for users will require further work.
The support for different number types in vector and matrix classes also enables the usage of automatic differentiation-based tools in
\trilinos{}, such as \texttt{NOX}.
To make the automatic differentiation tools of \trilinos{} accessible through the \tpetra{} interface without
requiring users to have an in-depth understanding of \trilinos{}, additional wrappers for the corresponding
\trilinos{} packages will be added in future releases.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{More support for advanced programming idioms}\label{sec:tools}

Over the years, \dealii{} has accumulated many classes and functions
that support modern programming idioms and make it easier to write
code at higher levels of abstraction.

In the current release, we have added two classes to the list of tools
of this kind:
\begin{itemize}
  \item
  \texttt{Lazy<T>} is a class that supports the lazy computation and
  initialization of variables. Its intended use is for member
  variables of classes that are \textit{sometimes} needed, but perhaps
  not for all uses of an object. For example, all finite element classes
  provide interpolation and restriction matrices to support multigrid
  and other algorithms. One could (i) always compute and store these
  matrices in the constructor of the class; or one could (ii) re-compute these
  matrices every time they are requested. The first of these
  approaches costs memory and compute time even though most places
  where one creates a finite element object will not actually query
  these matrices; the second of these approaches is costly in places
  that \textit{do} query these matrices repeatedly because they are re-computed
  every time. \texttt{Lazy<T>} provides a middle ground: It provides an
  abstraction for an object that is initialized upon first use (that
  is, the first time the value is requested), and then stores the
  computed value for cheap use later on.

  (C++ provides functionality via \texttt{std::async} with
  launch policy \texttt{std::launch::deferred} that can achieve
  similar outcomes. But this functionality is more difficult to use than
  \texttt{Lazy<T>} because, among other reasons, the code generating the
  object has to be specified at the place of construction of the
  object holding the result, rather than at the place of use; and
  because the holder object -- \texttt{std::future} -- can only be
  asked \textit{once} for its computed value.)

  \item \texttt{TaskResult<T>} is a class that represents the outcome
    of a task possibly evaluated on a separate thread. It can be
    thought of as a ``deferred'' result of a computation in that one
    wants to state ``This job needs to be done, do it when convenient,
    and then put the result of the operation into this
    variable''. Accessing the variable then waits for the operation to
    complete, if it has not already. \texttt{TaskResult<T>} allows
    classes to efficiently compute member variables in the background,
    assuming that they may not be needed right away but only later on.

    (Similar to above, the same effect as \texttt{TaskResult<T>} can
    be achieved using \texttt{std::async}, this time using the
    launch policy \texttt{std::launch::async}. This approach suffers
    from the same issue that one can only query the resulting object
    once. Moreover, \texttt{std::async} does not integrate with the
    thread pool that underlies \dealii{}'s approach to parallel
    processing on modern multi-core machines, whereas
    \texttt{TaskResult<T>} does.)
\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{New and improved tutorials and code gallery programs}
\label{subsec:steps}

Many of the \dealii tutorial programs were revised in a variety of ways
as part of this release: Around 190 of the more than 1900 (non-merge)
commits that went into this release touched the tutorial.
% data generated using these commands:
% - tutorial: git log --since 2023/07/07 --until 2024/08/11 --no-merges examples | grep commit | wc -l
% - total:    git log --since 2023/07/07 --until 2024/08/11 --no-merges | grep commit | wc -l
In addition, there are a number of new tutorial
programs:
\begin{itemize}
  \item
    \step{83}
    demonstrates how one can implement
    checkpoint/restart functionality in \dealii-based programs,
    using the \boost{} serialization functionality as a
    foundation. \step{83} was written by Pasquale Africa, Wolfgang
    Bangerth, and Bruno Blais using \step{19} as its basis.
  \item
    \step{86}
    is a program that solves the heat equation using \petsc's \ts{} (time
    stepping) framework for the solution of ordinary differential
    equations. Written by Wolfgang Bangerth, Luca Heltai, and Stefano Zampini
    (King Abdullah University of Science and Technology), it
    illustrates how PDE solvers for time-dependent problems can be
    integrated with existing ODE solver packages to use advanced ODE
    solver concepts (such as higher-order time integration methods and
    adaptive time step control), all without sacrificing the things
    that have traditionally led code authors toward writing their own
    time stepping routines (like wanting to change the mesh every
    once in a while, or having to deal with boundary conditions).
  \item
    \step{87}~\cite{schreter2023step87} was contributed by Magdalena Schreter-Fleischhacker
    and Peter Munch. It
    presents the advanced point-evaluation functionalities of \dealii,
    which are useful for evaluating finite element solutions at
    arbitrary points on meshes that can be distributed among
    processes. The presented mini-examples are motivated by the
    application to two-phase flow simulations and demonstrate, for
    example, the evaluation of solution quantities at a surface mesh
    embedded in a background mesh, as needed in the case in front-tracking.
  \item
    \step{89} was contributed by Johannes Heinz (TU Wien),
    Maximilian Bergbauer (Technical University of Munich),
    Marco Feder (SISSA), and Peter Munch.
    It shows how to apply non-matching and/or Chimera methods
    within matrix-free loops in \dealii.
  \item
    \step{90} was contributed by Vladimir Yushutin (Clemson University) and Timo Heister.
    It implements the trace finite element method (TraceFEM). TraceFEM solves PDEs
    posed on a, possibly evolving, $(dim-1)$-dimensional surface $\Gamma$ employing
    a fixed uniform background mesh of a $dim$-dimensional domain in which
    the surface is embedded. Such surface PDEs arise in problems involving
    material films with complex properties and in other situations in which
    a non-trivial condition is imposed on either a stationary or a moving interface.
    The program considers a steady, complex, non-trivial surface and the prototypical
    Laplace-Beltrami equation which is a counterpart of
    the Poisson problem on flat domains.
\end{itemize}

In addition, there are three new programs in the code gallery (a collection of
user-contributed programs that often solve more complicated problems
than tutorial programs, and that are intended as starting points for further
research rather than as teaching tools):
\todo[inline]{Marc Fehling: UPDATE ([W] Marc, you added this comment
  -- what did you want to update here? Perhaps add the affiliations of
the authors?)}
\begin{itemize}
  \item \textit{``Crystal growth phase field model''},
    contributed by Umair Hussain;
  \item \textit{``Nonlinear heat transfer problem''}, contributed by
    Narasimhan Swaminathan;
  \item \textit{``Traveling-wave solutions of a qualitative model for combustion waves''}, contributed by
    Shamil Magomedov.
\end{itemize}

Furthermore, we added an example to the \texttt{libCEED}
library~\cite{brown2021libceed}:
\url{https://github.com/CEED/libCEED/tree/main/examples/deal.II}.
\texttt{libCEED} is a library that provides matrix-free evaluation routines
for different hardware. The example shows how to interface the \dealii{}
data structures with the \texttt{libCEED} ones and solves the BP1-BP6
benchmarks (scalar/vector Laplace/mass matrix with regular integration and
over-integration).


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Relicensing to Apache License 2.0 with LLVM exception}
\label{sec:license}

The \dealii project is in the process of relicensing the library under the
terms of the \emph{Apache License 2.0 with LLVM
Exception} \cite{Apache-2.0,LLVM-Exception}. To this end we require all new
code contributions to be dual licensed under the current license (GNU
Lesser General Public License v2.1 \cite{LGPL-2.1}) and the new license
(Apache-2.0 with LLVM-exception).

We have chosen to pursue a relicensing effort for deal.II because of some
long standing problems with the LGPL v2.1 license. Most notably, despite
our clear intent that the strong copyleft principle should only apply to
deal.II source code and not user projects (which should be free to choose
their own license freely) this is not necessarily the case for LGPL v2.1
due to the language used in the library. This makes potential industry
partners that evaluate the use of deal.II for their own projects nervous.
Secondly, our previous choice to use an open source license with strong
copyleft was motivated by our hope that we receive back code contributions
from third parties. In practice, however, our observation over the
last 10 years is that
our choice of license has not helped achieve this goal: Copyleft only applies when a derived
software is sold or published. But almost all of our code contributions are
voluntary and come from individual contributors with an academic
background, where these considerations do not apply.

We have thus decided to switch away from the LGPL v2.1 license towards a
more permissible license. We settled on the Apache License 2.0 with
LLVM-exception in large parts because it is (a)~a permissible open source
license with patent clause, (b)~considered to be a verbose, well-written
license, and (c)~has been recently chosen by other large open source
projects, notably \llvm{} and \kokkos{}. Our hope going forward is
that the new license makes it easier for industry partners to use the library.

As a first step we now require all new code contributions to be dual
licensed under the old and new licenses. As a second step we are in the
process of contacting the more than 200 past contributors with copyrighted
contributions to the library. As of September 2024 roughly 80\% of the
commits and 80\% of the 1.88 million source lines of code have been
relicensed.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Incompatible changes}\label{subsec:deprecated}

The 9.6 release includes
\href{https://dealii.org/developer/doxygen/deal.II/changes_between_9_5_2_and_9_6_0.html}
     {around 40 incompatible changes};
see \cite{changes96}. Many of these
incompatibilities change internal
interfaces that are not usually used in external
applications. That said, the following are worth mentioning since they
are more broadly visible:
\begin{itemize}
  \item \dealii{} now requires compilers to support C++17, and has
    started to extensively use C++17 features.
  \item The \texttt{CUDAWrappers} namespace and its contents --
    notably things that enable the usage of \texttt{cuSPARSE} algorithms --
    have been deprecated and will be removed in the next
    release. \kokkos{} is now used for device-specific optimizations.
\end{itemize}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{How to cite \dealii}\label{sec:cite}

In order to justify the work the developers of \dealii put into this
software, we ask that papers using the library reference one of the
\dealii papers. This helps us justify the effort we put into this library.

There are various ways to reference \dealii. To acknowledge the use of
the current version of the library, \textbf{please reference the present
  document}. For up-to-date information and a bibtex entry
see
\begin{center}
  \url{https://www.dealii.org/publications.html}
\end{center}

The original \dealii paper containing an overview of its
architecture is \cite{BangerthHartmannKanschat2007}, and a more recent
publication documenting \dealii's design decisions is available as \cite{dealII2020design}. If you rely on
specific features of the library, please consider citing any of the
following:
\begin{multicols}{2}
  \vspace*{-36pt}
  \begin{itemize}[leftmargin=4mm]
    \item For geometric multigrid: \cite{Kanschat2004,JanssenKanschat2011,ClevengerHeisterKanschatKronbichler2019, munch2022gc};
    \item For distributed parallel computing: \cite{BangerthBursteddeHeisterKronbichler11};
    \item For $hp$-adaptivity: \cite{BangerthKayserHerold2007,fehlingbangerth2023};
    \item For partition-of-unity (PUM) and finite element enrichment methods:
           \cite{Davydov2016};
    \item For matrix-free and fast assembly techniques:
          \cite{KronbichlerKormann2012,KronbichlerKormann2019};
    \item For computations on lower-dimensional manifolds:
          \cite{DeSimoneHeltaiManigrasso2009};
    \item For curved geometry representations and manifolds:
          \cite{HeltaiBangerthKronbichlerMola2019};
    \item For integration with CAD files and tools:
          \cite{HeltaiMola2015};
    \item For boundary element computations:
          \cite{GiulianiMolaHeltai-2018-a};
    \item For the \texttt{LinearOperator} and
      \texttt{Packaged\-Operation} facilities:
          \cite{MaierBardelloniHeltai-2016-a,MaierBardelloniHeltai-2016-b};
    \item For uses of the \texttt{WorkStream} interface:
          \cite{TKB16};
    \item For uses of the \texttt{ParameterAcceptor} concept, the
          \texttt{MeshWorker::ScratchData} base class, and the
          \texttt{ParsedConvergenceTable} class:
          \cite{SartoriGiulianiBardelloni-2018-a};
    \item For uses of the particle functionality in \dealii:
          \cite{GLHPB18}.
          \vfill\null
  \end{itemize}
\end{multicols}

\dealii can interface with many other libraries:
\begin{multicols}{3}
  \begin{itemize}[leftmargin=4mm]
    \item ADOL-C \cite{griewank1996adolc}
    \item ArborX \cite{lebrun2020arborx}
    \item ARPACK \cite{lehoucq1998arpack}
    \item Assimp \cite{schulze2021assimp}
    \item BLAS and LAPACK \cite{anderson1999lapack}
    \item Boost \cite{boost-web-page}
    \item CGAL \cite{cgal-user-ref}
    \item cuSOLVER \cite{cusolver-web-page}
    \item cuSPARSE \cite{cusparse-web-page}
    \item Gmsh \cite{geuzaine2009gmsh}
    \item GSL \cite{galassi2009gsl,gsl-web-page}
    \item Ginkgo \cite{anzt2020ginkgo,anzt2022ginkgo}
    \item HDF5 \cite{hdf5-web-page}
    \item METIS \cite{karypis1998metis}
    \item MUMPS \cite{amestoy2001mumps,amestoy2019mumps}
    \item muparser \cite{muparser-web-page}
    \item OpenCASCADE \cite{opencascade-web-page}
    \item p4est \cite{burstedde2011p4est}
    \item PETSc \cite{petsc-user-ref,petsc-web-page}
    \item ROL \cite{ridzal2014rol}
    \item ScaLAPACK \cite{blackford1997scalapack}
    \item SLEPc \cite{hernandez2005slepc}
    \item SUNDIALS \cite{hindmarsh2005sundials}
    \item SymEngine \cite{symengine-web-page}
    \item Taskflow \cite{huang2021taskflow}
    \item TBB \cite{reinders2007tbb}
    \item Trilinos \cite{heroux2005trilinos,trilinos-web-page}
    \item UMFPACK \cite{davis2004umfpack}
  \end{itemize}
\end{multicols}
Please consider citing the appropriate references if you use
interfaces to these libraries.

The two previous releases of \dealii can be cited as
\cite{dealII94,dealII95}.


\section{Acknowledgments}

\dealii is a worldwide project with dozens of contributors around the
globe. Other than the authors of this paper, the following people
contributed code to this release:\\

% This is up-to-date as of 2024-07-23 11:52PM CEST
\begin{quote}
Laryssa      Abdala,
Mathias      Anselmann,
Abbas        Ballout,
Maximilian   Bergbauer,
Julian       Brotz,
Marco        Feder,
Niklas       Fehn,
Menno        Fraters,
Quang        Hoang,
Vladimir     Ivannikov,
Tao          Jin,
Yimin        Jin,
Sebastian    Kinnewig,
Paras        Kumar,
Sébastien    Loriot,
Nils         Much,
Abdullah     Mujahid,
Bob          Myhill,
Paul A.      Patience,
Luz          Paz,
Laura        Prieto Saavedra,
Sebastian    Proell,
Hendrik      Ranocha,
Johannes     Resch,
Andreas      Ritthaler,
Malik        Scheifinger,
David        Schneider,
%Magdalena    Schreter-Fleischhacker,
Richard      Schussnig,
Nils         Schween,
Kyle         Schwiebert,
Simranjeet   Singh,
Simon        Sticko,
Dominik      Still,
%Jan Philipp  Thiele,
Thierry      Thomas,
Vinayak      Vijay,
Ivy          Weber,
Simon        Wiesheier,
Chengjiang   Yin,
%Vladimir     Yushutin,
Stefano      Zampini.
\end{quote}
Their contributions are much appreciated!


\bigskip

\dealii and its developers are financially supported through a
variety of funding sources:

P.~C.~Africa was partially supported by the consortium iNEST (Interconnected North-East Innovation Ecosystem),
Piano Nazionale di Ripresa e Resilienza (PNRR) - Missione 4 Componente 2, Investimento 1.5 - D.D. 1058 23/06/2022,
ECS00000043, supported by the European Union's NextGenerationEU program.

D.~Arndt and B.~Turcksin: Research sponsored by the Laboratory Directed Research and
Development Program of Oak Ridge National Laboratory, managed by UT-Battelle,
LLC, for the U. S. Department of Energy.

W.~Bangerth and M.~Fehling were partially supported by Award OAC-1835673
as part of the Cyberinfrastructure for Sustained Scientific Innovation (CSSI)
program.

W.~Bangerth, T.~Heister, and R.~Gassm\"{o}ller were partially
supported by the Computational Infrastructure for Geodynamics initiative
(CIG), through the National Science Foundation (NSF) under Award
No.~EAR-2149126 via The University of California -- Davis.

W.~Bangerth was also partially supported by Award EAR-1925595.

B.~Blais was supported by the National Science and Engineering Research Council of Canada (NSERC)  through the RGPIN-2020-04510 Discovery Grant and the MMIAOW Canada Research Level 2 in Computer-Assisted Design and Scale-up of Alternative Energy Vectors for Sustainable Chemical Processes.

M.~Fehling was also partially supported by the ERC-CZ grant LL2105
CONTACT, funded by the Czech Ministry of Education, Youth and Sports.

R.~Gassm\"{o}ller was also partially supported by NSF Awards EAR-1925677
and EAR-2054605.

T.~Heister and V.~Yushutin were also partiallty supported by NSF Awards OAC-2015848 and EAR-1925575.

T.~Heister was also partially supported by NSF OAC-2410848.

L.~Heltai was partially supported by the Italian Ministry of
University and Research (MUR), under the grant MUR PRIN 2022 No. 2022WKWZA8
``Immersed methods for multiscale and multiphysics problems (IMMEDIATE)''.

S.~Kinnewig was supported by the Deutsche Forschungsgemeinschaft (DFG) under Germany’s Excellence
Strategy within the Cluster of Excellence PhoenixD (EXC 2122, Project ID 390833453)

M.~Kronbichler and P.~Munch were partially supported by the
German Ministry of Education and Research, project
``PDExa: Optimized software methods for solving partial differential
equations on exascale supercomputers'' and the Bayerisches Kompetenznetzwerk
f\"ur Technisch-Wissen\-schaft\-li\-ches Hoch- und H\"ochstleistungsrechnen
(KONWIHR), project ``Fast and scalable finite element algorithms for coupled
multiphysics problems and non-matching grids''.

M.~Maier was partially supported by NSF Award DMS-2045636 and and by the
Air Force Office of Scientific Research under grant/contract number
FA9550-23-1-0007.

P.~Munch acknowledges the funding by the Swedish Research Council (VR) under grant 2021-04620 and the strategic funding from the IT department of Uppsala University.

M.~Schreter-Fleischhacker was supported by the Austrian Science Fund (FWF) Schrödinger Fellowship (project number: J4577) and by the European Research Council
through the ERC Starting Grant ExcelAM (project number: 101117579).

D.~Wells was supported by NSF Award OAC-1931516.

Clemson University is acknowledged for generous allotment of compute
time on the Palmetto cluster.

The authors acknowledge the Texas Advanced Computing Center (TACC) at The University of Texas at Austin for providing HPC resources that have contributed to the research results reported within this paper. \url{http://www.tacc.utexas.edu}

\todo[inline]{Marc: please insert allocation}

This work used [resource-name] at [resource provider] through allocation [allocation number] from the Advanced Cyberinfrastructure Coordination Ecosystem: Services \& Support (ACCESS) program, which is supported by National Science Foundation grants \#2138259, \#2138286, \#2138307, \#2137603, and \#2138296. See \cite{Boerner2023}.


This work used the Extreme Science and Engineering Discovery Environment (XSEDE), which is supported by National Science Foundation grant number ACI-1053575 access through the CIG Science Gateway and Community Codes for the Geodynamics Community MCA08X011 allocation.


\bibliography{paper}{}
\bibliographystyle{abbrv}

\end{document}
