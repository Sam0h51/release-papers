\documentclass{ansarticle-preprint}
%\usepackage{ucs}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
%\usepackage{cite}
\usepackage{anslistings}
\usepackage{multicol}

\usepackage{pgfplots}
\usepackage{pgfplotstable}

\usepackage{fontenc}
\usepackage{graphicx}
\usepackage{xspace}

\pgfplotsset{compat=1.9}

\newcommand{\specialword}[1]{\texttt{#1}}
\newcommand{\dealii}{{\specialword{deal.II}}\xspace}
\newcommand{\pfrst}{{\specialword{p4est}}\xspace}
\newcommand{\trilinos}{{\specialword{Trilinos}}\xspace}
\newcommand{\aspect}{\specialword{Aspect}\xspace}
\newcommand{\petsc}{\specialword{PETSc}\xspace}
\newcommand{\cmake}{{\specialword{CMake}}\xspace}
\newcommand{\autoconf}{{\specialword{autoconf}}\xspace}

%
% Author list -- please add yourself in both places below (in
%                alphabetical order) if you think that your
%                contributions to the last release warrant this
%

\hypersetup{
  pdfauthor={
    Daniel Arndt,
    Wolfgang Bangerth,
    Denis Davydov,
    Timo Heister,
    Luca Heltai,
    Martin Kronbichler,
    Matthias Maier,
    Jean-Paul Pelteret,
    Bruno Turcksin,
    David Wells
  },
  pdftitle={The deal.II Library, Version 9.1, 2019},
}

\title{The \dealii Library, Version 9.1}

\author[1]{Daniel Arndt \footnote{
  This manuscript has been authored by UT-Battelle, LLC under Contract No.
  DE-AC05-00OR22725 with the U.S. Department of Energy. The United States
  Government retains and the publisher, by accepting the article for
  publication, acknowledges that the United States Government retains a
  non-exclusive, paid-up, irrevocable, worldwide license to publish or reproduce
  the published form of this manuscript, or allow others to do so, for United
  States Government purposes. The Department of Energy will provide public
  access to these results of federally sponsored research in accordance with the
  DOE Public Access Plan (http://energy.gov/downloads/doe-public-access-plan).}}
\affil[1]{Computational Engineering and Energy Sciences Group,
  Computional Sciences and Engineering Division,
  Oak Ridge National Laboratory, 1 Bethel Valley Rd.,
  TN 37831, USA.
  {\texttt{\{arndtd,turcksinbr\}@ornl.gov}}}

\author[2]{Wolfgang~Bangerth}
\affil[2]{Department of Mathematics, Colorado State University, Fort
  Collins, CO 80523-1874, USA.
    {\texttt{bangerth@colostate.edu}}}

\author[3]{Denis~Davydov}
\affil[3]{Chair of Applied Mechanics,
  Friedrich-Alexander-Universit\"{a}t Erlangen-N\"{u}rnberg,
  Egerlandstr.\ 5,
  91058 Erlangen, Germany.
  {\texttt{\{denis.davydov,jean-paul.pelteret\}@fau.de}}}

\author[4]{Timo~Heister}
\affil[4]{Mathematical Sciences,
  O-110 Martin Hall,
  Clemson University,
  Clemson, SC 29634, USA.
  {\texttt{heister@clemson.edu}}}
%
\author[5]{Luca~Heltai}
\affil[5]{SISSA,
  International School for Advanced Studies,
  Via Bonomea 265,
  34136, Trieste, Italy.
{\texttt{luca.heltai@sissa.it}}}

\author[6]{Martin~Kronbichler}
\affil[6]{Institute for Computational Mechanics,
  Technical University of Munich,
  Boltzmannstr.~15, 85748 Garching, Germany.
  {\texttt{kronbichler@lnm.mw.tum.de}}}

\author[7]{Matthias~Maier}
\affil[7]{Department of Mathematics,
  Texas A\&M University,
  3368 TAMU,
  College Station, TX 77845, USA.
  {\texttt{maier@math.tamu.edu}}}

\author[4]{Jean-Paul~Pelteret}

\author[1]{Bruno~Turcksin}

\author[9]{David Wells}
\affil[9]{Department of Mathematical Sciences, Rensselaer Polytechnic
Institute, Troy, NY 12180, USA.
  {\texttt{wellsd2@rpi.edu}}}

\renewcommand{\labelitemi}{--}


\begin{document}
\maketitle

\begin{abstract}
  This paper provides an overview of the new features of the finite element
  library \dealii version 9.1.
\end{abstract}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Overview}

\dealii version 9.1.0 was released May XX, 2019
This paper provides an
overview of the new features of this major release and serves as a citable
reference for the \dealii software library version 9.1. \dealii is an
object-oriented finite element library used around the world in the
development of finite element solvers. It is available for free under the
GNU Lesser General Public License (LGPL) from the \dealii homepage at
\url{http://www.dealii.org/}.

The major changes of this release are:
\begin{itemize}
\item Improved support for automatic and symbolic differentiation;
\item Full support for $hp$ adaptivity in parallel computations;
\item Interfaces to the HDF5 file format and libraries.
\item Four new tutorial programs step-61, step-62, step-63, step-64,
  as well as one new code gallery program.
\end{itemize}
These will all be discussed in more detail in the
following section. There are a number of other noteworthy changes in this release:
\begin{itemize}
\item A number of bug fixes and performance improvements to the
  matrix-free framework and related geometric multigrid solvers. In
  particular, the implementation of the Chebyshev iteration, an often
  used smoother in the matrix-free context, has been revised to reduce
  vector accesses. This speeds up matrix-free
  multigrid solvers by up to 10-15\% on geometries with affine
  (parallelogram and parallelpiped) cells, and up to
  5\% on geometries with cells bounded by curved edges and faces.
\marginpar{Luca: Please expand}
\item ParsedConvergenceTable.
\item The \texttt{FE\_BernardiRaugel} class implements the
  non-standard Bernardi-Raugel (BR) element that can be used as one part of
  a stable velocity/pressure pair for the Stokes equation
  \cite{BR85}. The BR element can be seen as either an enriched
  version of the $Q_1^d$ element with added bubble functions on each
  edge (in 2d) or face (in 3d), or as a reduced version of the $Q_2^d$
  element. It addresses the fact that the $Q_1^d\times Q_0$
  combination is not inf-sup stable (requiring a larger velocity
  space), and that the $Q_2^d\times Q_1$ combination is stable but
  sub-optimal since the velocity space is too large relative to the
  pressure space to provide additional accuracy commensurate with the
  cost of the large number of velocity unknowns. The BR space is
  intermediate to the $Q_1^d$ and $Q_2^d$ spaces.

  The current implementation of the element only works for
  parallelogram meshes due to difficulties associated with the mapping
  of shape functions: The shape functions of the $Q_1^d$ part of the
  element need to be mapped as scalars, as is common for the vector
  components of the $Q_1^d$ element; on the other hand, the
  vector-valued edge bubble functions need to be mapped using the
  Piola transform as is common for the Raviart-Thomas
  element. \dealii{} does not currently have the ability to use
  different mappings for individual shape functions, though this
  functionality is planned for the next release.

\item The \texttt{FE\_NedelecSZ} class is an alternative
  implementation of the ideas behind the N{\'e}d{\'e}elec element. It is based
  on the work of Zaglmayr \cite{Zag06} and overcomes the
  sign conflict issues present in traditional N{\'e}d{\'e}lec
  elements that arise from the edge and face parameterizations used
  in the basis functions. Therefore, this element should provide
  consistent results for general quadrilateral and hexahedral
  elements for which the relative orientations of edges and faces as
  seen from all adjacent cells are often difficult to establish.
  The way this element addresses the sign conflict problem is to assign
  local edges and faces a globally defined orientation. The
  implementation is described in \cite{Kynch2017}.

  \marginpar{Maybe also mention the rtree interfaces?}
\end{itemize}

Beyond these changes, the changelog lists more than 200 other features and bugfixes.




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Significant changes to the library}

This release of \dealii contains a number of large and significant changes
that will be discussed in the following sections. It of course also contains a
vast number of smaller changes and added functionality; the details of these
can be found
\href{https://dealii.org/developer/doxygen/deal.II/changes_between_9_0_1_and_9_1_0.html}{
in the file that lists all changes for this release}, see \cite{changes91}.
(The file is also linked to from the web site of each release as well as
the release announcement.)
\marginpar{check that URL works!}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Improved support for automatic and symbolic differentiation}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Full support for $hp$ adaptivity in parallel computations}

\dealii{} has had support for $hp$ adaptive methods since around 2005
(documented in \cite{BangerthKayserHerold2007} and for parallel
computations on distributed meshes since around 2010 (see
\cite{BangerthBursteddeHeisterKronbichler11}), but not for both at the
same time. The challenges to combine these are related to a number of
areas:
\begin{enumerate}
\item Data structures: The data structures necessary to store the
  indices of degrees of freedom are necessarily substantially more
  complicated for $hp$ algorithms than for the $h$-adaptive schemes
  that were already implemented. This is because the number of degrees
  of freedom per cell is now no longer constant. Furthermore,
  faces and edges may need to store more than one set of indices if
  the adjacent cells use different polynomial degrees; in the case of
  edges, the number of sets of indices may also be of variable size.

  All of this poses challenges in the parallel context because some of
  the information may not be known, or not be known right away, for
  cells that are not locally owned (i.e., for ghost and ``artificial''
  cells), and for which the data structures stored on different
  processors have to reconciled.
  
\item Algorithms: Already for $h$ adaptive meshes, enumerating all
  degrees of freedom on the global mesh is difficult as evidenced by
  the complications of the algorithms shown in Section 3.1 of
  \cite{BangerthBursteddeHeisterKronbichler11}, which requires more
  than a page of text and is implemented in many hundreds of lines of
  code).

  These difficulties are even more pronounced when using $hp$
  adaptivity. The main obstacle is the desire to unify the indices of
  matching degrees of freedom on adjacent cells, such as the edge
  since degree of freedom of a $Q_2$ element with the middle one of
  the three edge degrees of freedom of a $Q_4$ element on a
  neighboring cell. Section 4.2 of
  \cite{BangerthKayserHerold2007} discusses a sequential algorithm
  that eliminates one of these degrees of freedom in favor of another,
  but in this introduces a ``master'' and a ``slave'' side of the
  interface. This is of no major consequence in sequential
  computations, but is inconvenient in parallel computations if the
  ``master'' side is a ghost cell whose degree of freedom indices are
  not (yet) available while enumerating local degrees of freedom, or
  if the master is an artificial cell whose information will never be
  available on a processor.

  An earlier implementation of the algorithm enumerating degrees of
  freedom, already available in \dealii{} 9.0, simply did not unify
  indices on processor boundaries. However, this makes the total
  number of degrees of freedom dependent on both the partition of the
  mesh and the number of processors available. We have therefore
  re-implemented the algorithm so that the unification does happen
  also on processor boundaries, and will report on the details
  elsewhere.
  
\item Data transfer patterns: An important algorithm in parallel
  finite element methods is the exchange of information stored on
  cells during mesh repartitioning. This happens, for example, when
  interpolating the solution from one mesh to the next,
  adaptively-refined mesh, or when adapting the polynomial degrees of
  freedom associated with each cell and repartitioning in order to
  balance the computational cost of each processor's partition. When
  using $h$ adaptive methods, the amount of data associated with each
  cell is fixed and the algorithms that implement the data transfer
  are consequently relatively simple. On the other hand, in $hp$
  contexts, each cell may have a different number of unknowns
  associated with it, and the algorithms that transfer the data are
  substantially more complicated. Furthermore, the amount of data
  associated with each cell may be large on cells with higher
  polynomial degrees, and might profit from compression before
  sending.

\item Balancing computational cost: For $h$-adaptive algorithms, the
  amount of work associated with each cell is essentially the same
  both during the assembly of linear systems as well as during the
  solver phase. For $hp$-adaptive methods, this is no longer the
  case. Consequently, balancing the cost of work between different
  processors' partitions is no longer as easy as ensuring that every
  processor owns a roughly equal number of cells. Rather, one needs to
  introduce a weighting factor for each cell that describes its
  relative cost compared to some reference. To make things work, the
  relative cost of assembly on a cell might now match the relative
  cost of the linear solver associated with this cell, leading to
  difficult trade-offs in defining optimal weighting factors.
\end{enumerate}

All of these issues have been addressed in the current release and are
available to users. We will report on the details of the algorithms
and their performance in a separate publication.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Interfaces to the HDF5 file format and libraries}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{New and improved tutorial and code gallery programs}

talk about the new programs; also mention updating for C++11 style


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Incompatible changes}

\marginpar{Update after the release}
The 9.1 release includes
\href{https://dealii.org/developer/doxygen/deal.II/changes_between_9_0_0_and_9_1_0.html}
     {around 15 incompatible changes}; see \cite{changes91}. The majority of these changes
should not be visible to typical user codes; some remove previously
deprecated classes and functions, and the majority change internal
interfaces that are not usually used in external
applications. However, some are worth mentioning:
\begin{itemize}
\item TODO
\end{itemize}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{How to cite \dealii}\label{sec:cite}

In order to justify the work the developers of \dealii put into this
software, we ask that papers using the library reference one of the
\dealii papers. This helps us justify the effort we put into it.

There are various ways to reference \dealii. To acknowledge the use of
the current version of the library, \textbf{please reference the present
document}. For up to date information and bibtex snippets for this document
see:
\begin{center}
 \url{https://www.dealii.org/publications.html}
\end{center}

The original \texttt{\dealii} paper containing an overview of its
architecture is \cite{BangerthHartmannKanschat2007}. If you rely on
specific features of the library, please consider citing any of the
following:
\begin{itemize}
 \item For geometric multigrid: \cite{Kanschat2004,JanssenKanschat2011,ClevengerHeisterKanschatKronbichler2019,KronbichlerLjungkvist2019};
 \item For distributed parallel computing: \cite{BangerthBursteddeHeisterKronbichler11};
 \item For $hp$ adaptivity: \cite{BangerthKayserHerold2007};
  \item For partition-of-unity (PUM) and enrichment methods of the
    finite element space: \cite{Davydov2016};
 \item For matrix-free and fast assembly techniques:
   \cite{KronbichlerKormann2012,KronbichlerKormann2019};
 \item For computations on lower-dimensional manifolds:
   \cite{DeSimoneHeltaiManigrasso2009};
 \item For integration with CAD files and tools:
   \cite{HeltaiMola2015};
 \item For Boundary Elements Computations:
   \cite{GiulianiMolaHeltai-2018-a};
 \item For \texttt{LinearOperator} and \texttt{PackagedOperation} facilities:
   \cite{MaierBardelloniHeltai-2016-a,MaierBardelloniHeltai-2016-b}.
 \item For uses of the \texttt{WorkStream} interface:
   \cite{TKB16}.
\end{itemize}

\marginpar{I'm sure we have new interfaces. HDF5 and the various AD/SD
  libraries come to mind. Please update.}
\dealii can interface with many other libraries:
\begin{multicols}{3}
\begin{itemize}
\item ADOL-C \cite{Griewank1996a,adol-c}
\item ARPACK \cite{arpack}
\item Assimp \cite{assimp}
\item BLAS and LAPACK \cite{lapack}
\item cuSOLVER \cite{cusolver}
\item cuSPARSE \cite{cusparse}
\item Gmsh \cite{geuzaine2009gmsh}
\item GSL \cite{gsl2016}
\item HDF5 \cite{hdf5}
\item METIS \cite{karypis1998fast}
\item MUMPS \cite{ADE00,MUMPS:1,MUMPS:2,mumps-web-page}
\item muparser \cite{muparser-web-page}
\item nanoflann \cite{nanoflann}
\item NetCDF \cite{rew1990netcdf}
\item OpenCASCADE \cite{opencascade-web-page}
\item p4est \cite{p4est}
\item PETSc \cite{petsc-user-ref,petsc-web-page}
\item ROL \cite{ridzal2014rapid}
\item ScaLAPACK \cite{slug}
\item SLEPc \cite{Hernandez:2005:SSF}
\item SUNDIALS \cite{sundials}
\item TBB \cite{Rei07}
\item Trilinos \cite{trilinos,trilinos-web-page}
\item UMFPACK \cite{umfpack}
\end{itemize}
\end{multicols}
Please consider citing the appropriate references if you use interfaces to these
libraries.

The two previous releases of \dealii can be cited as
\cite{dealII85,dealII90}.


\section{Acknowledgments}

\dealii is a world-wide project with dozens of contributors around the
globe. Other than the authors of this paper, the following people contributed code to
this release:\\
%
% get this from the changes/*/* files using the command listed in the
% release-tasks paper and remove the authors of this paper
%
% updated 5/12/2019
\marginpar{Remove all other authors of this paper}
\marginpar{Do we want to spell out who the Gingko devs are?}
  Giovanni Alzetta,
  Mathias Anselmann,
  Daniel Appel,
  Alexander Blank,
  Vishal Boddu,
  Benjamin Brands,
  Pi-Yueh Chuang,
  T. Conrad Clevenger,
  Sambit Das,
  the Ginkgo developers,
  Stefano Dominici,
  Nivesh Dommaraju,
  Marc Fehling,
  Niklas Fehn,
  Isuru Fernando,
  Andreas Fink,
  Daniel Garcia-Sanchez,
  Rene Gassm{\"o}ller,
  Alexander Grayver,
  Joshua Hanophy,
  Logan Harbour,
  Graham Harper,
  Daniel Jodlbauer,
  Stefan Kaessmair,
  Eldar Khattatov,
  Alexander Knieps,
  Uwe K{\"o}cher,
  Kurt Kremitzki,
  Dustin Kumor,
  Ross Kynch,
  Damien Lebrun-Grandie,
  Jonathan Matthews,
  Stefan Meggendorfer,
  Pratik Nayak,
  Lei Qiao,
  Ce Qin,
  Reza Rastak,
  Roland Richter,
  Alberto Sartori,
  Svenja Schoeder,
  Sebastian Stark,
  Antoni Vidal,
  Jiaxin Wang,
  Yuxiang Wang,
  Zhuoran Wang.

Their contributions are much appreciated!


\bigskip

\dealii and its developers are financially supported through a
variety of funding sources:

D.~Arndt and M.~Kronbichler were partially supported by the German
Research Foundation (DFG) under the project ``High-order discontinuous
Galerkin for the exa-scale'' (\mbox{ExaDG}) within the priority program ``Software
for Exascale Computing'' (SPPEXA).

W.~Bangerth and T.~Heister were partially
supported by the National Science Foundation under award OAC-1835673
as part of the Cyberinfrastructure for Sustained Scientific Innovation (CSSI)
program; by award DMS-1821210; and by the Computational Infrastructure
in Geodynamics initiative (CIG), through the National Science
Foundation under Awards No.~EAR-0949446 and EAR-1550901 and The
University of California -- Davis.

D.~Davydov was supported by the German Research Foundation (DFG), grant DA
1664/2-1 and the Bayerisches Kompetenznetzwerk
f\"ur Technisch-Wissenschaftliches Hoch- und H\"ochstleistungsrechnen
(KONWIHR).

T.~Heister was also partially supported by NSF Award DMS-1522191, and
by Technical Data Analysis, Inc. through US Navy SBIR N16A-T003.

M.~Maier was partially supported by ARO MURI Award No. W911NF-14-0247.

J-P.~Pelteret was supported by the European Research Council (ERC) through
the Advanced Grant 289049 MOCOPOLY.

B.~Turcksin: This material is based upon work supported by the U.S.
Department of Energy, Office of Science, under contract number
DE-AC05-00OR22725.

D.~Wells was supported by the National Science Foundation (NSF) through Grant
DMS-1344962.

The Interdisciplinary Center for Scientific Computing (IWR) at Heidelberg
University has provided hosting services for the \dealii web page.


\bibliography{paper}{}
\bibliographystyle{abbrv}

\end{document}
